# 15 抽象工厂模式

## 定义

### 提供一个创建一系列相关或相互依赖的对象的接口，而无需指定它们具体的类

## 概念

### 产品族

#### 例如数据库访问层的某一对象模型表示

### 具体产品

#### 例如：通过特定的数据库引擎对某一对象模型的访问

### 抽象工厂

#### 定义获取对象模型访问的client的接口

### 具体工厂

#### 实现通过特定数据库引擎获取具体对象模型的访问client

## 应用场景

### 数据库访问层封装，支持不同的数据库引擎

#### 抽象工厂定义一系列获取不同的对象模型访问的client的接口

#### 具体工厂实现获取client的接口，根据所代表的数据库引擎获取特定产品族下的相关对象模型访问client

#### 增加对新的数据库引擎的支持时，需要

##### 实现新的具体工厂

##### 实现一个新的产品族，在该产品族内实现所有的具体产品类

## 改进

### 问题1

#### 如果使用指定具体工厂的地方很多，修改时不便（工厂模式与抽象工厂模式的缺点）

#### 解决方案

##### 结合简单工厂模式

##### 问题2

###### 问题2.1判断语句多

####### 解决方案

######## 反射

######### 不用条件判断语句判断生成哪个类实例，而用变量拼接成指定的类型，然后生成指定的类实例

###### 问题2.2 修改指定具体工厂类的变量时需要重新编译

####### 解决方案

######## 将用于反射的变量写在配置文件中，程序运行时读取配置文件

## 简单工厂模式 vs 工厂模式 vs 抽象工厂模式

### 抽象工厂模式中多了产品族的概念，分别由一个抽象产品类定义

### 简单工厂模式通过一个工厂类对象获取指定的具体产品，依赖条件判断语句进行判断

### 工厂模式对工厂进行了一次抽象，利用多态把对象的创建延迟到具体的产品类实例，解决了简单工厂模式可能存在的大量条件判断语句的问题

### 抽象工厂模式这个命名很奇怪，因为抽象工厂模式可以看作是在工厂模式的基础上添加产品族的概念后形成的新模式。工厂模式中的工厂也是有抽象的，因此这个命名用在工厂模式上也可以啊，为什么引入产品族后的工厂模式要名为“抽象工厂模式”呢？just a name
